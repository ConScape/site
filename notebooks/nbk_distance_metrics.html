<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ConScape - the docs - Ecological distance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notebooks/nbk_cost.html" rel="next">
<link href="../notebooks/nbk_landmarks.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Ecological distance</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/stickerConScape.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Home</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quick_start.html" class="sidebar-item-text sidebar-link">Quick start</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../background.html" class="sidebar-item-text sidebar-link">Background</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../applications/index.html" class="sidebar-item-text sidebar-link">Applications</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../applications/GI.html" class="sidebar-item-text sidebar-link">Green infrastructure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../applications/EIA.html" class="sidebar-item-text sidebar-link">Environmental impact assessment</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Tutorials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/index.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_getting_started.html" class="sidebar-item-text sidebar-link">Getting started</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_landmarks.html" class="sidebar-item-text sidebar-link">Performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_distance_metrics.html" class="sidebar-item-text sidebar-link active">Ecological distance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_cost.html" class="sidebar-item-text sidebar-link">Dispersal mortality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_functionality_variants.html" class="sidebar-item-text sidebar-link">Functional habitat</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../faq.html" class="sidebar-item-text sidebar-link">FAQ</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../faqV2.html" class="sidebar-item-text sidebar-link">FAQ</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../glossary.html" class="sidebar-item-text sidebar-link">Glossary</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../acknowledgments.html" class="sidebar-item-text sidebar-link">Acknowledgments</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../team.html" class="sidebar-item-text sidebar-link">The team and contact</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../blog.html" class="sidebar-item-text sidebar-link">Blog</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#demonstration-of-distance-and-proximity-metrics" id="toc-demonstration-of-distance-and-proximity-metrics" class="nav-link active" data-scroll-target="#demonstration-of-distance-and-proximity-metrics">Demonstration of distance and proximity metrics</a>
  <ul class="collapse">
  <li><a href="#data-import-grid-and-gridrsp-creation" id="toc-data-import-grid-and-gridrsp-creation" class="nav-link" data-scroll-target="#data-import-grid-and-gridrsp-creation">Data import, <code>Grid</code> and <code>GridRSP</code> creation</a></li>
  <li><a href="#euclidean-distance" id="toc-euclidean-distance" class="nav-link" data-scroll-target="#euclidean-distance">Euclidean distance</a></li>
  <li><a href="#least-cost-distance" id="toc-least-cost-distance" class="nav-link" data-scroll-target="#least-cost-distance">Least-cost distance</a></li>
  <li><a href="#rsp-expected-cost-distance" id="toc-rsp-expected-cost-distance" class="nav-link" data-scroll-target="#rsp-expected-cost-distance">RSP expected cost distance</a></li>
  <li><a href="#survival-probability" id="toc-survival-probability" class="nav-link" data-scroll-target="#survival-probability">Survival probability</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Ecological distance</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Here you will learn
</div>
</div>
<div class="callout-body-container callout-body">
<p>Different ecological distance and proximity metrics implemented in ConScape.</p>
</div>
</div>
<section id="demonstration-of-distance-and-proximity-metrics" class="level1">
<h1>Demonstration of distance and proximity metrics</h1>
<p>In this notebook we demonstrate different types of distances and proximities that can be used in ConScape to quantify the connectivity between source and target pixels.</p>
<section id="data-import-grid-and-gridrsp-creation" class="level2">
<h2 class="anchored" data-anchor-id="data-import-grid-and-gridrsp-creation">Data import, <code>Grid</code> and <code>GridRSP</code> creation</h2>
<p>See notebook <a href="../notebooks/nbk_getting_started.html">Getting Started</a> for a ‘basic workflow’ to learn about the fundamentals on data import and the creation of a ConScape <code>Grid</code>:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#using Pkg</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Pkg.activate(joinpath(ENV["HOME"], ".julia", "dev", "ConScape"))</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ConScape</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SparseArrays</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>datadir <span class="op">=</span> <span class="fu">joinpath</span>(<span class="cn">ENV</span>[<span class="st">"HOME"</span>], <span class="st">"Downloads"</span>, <span class="st">"input_maps"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>outdir <span class="op">=</span> <span class="fu">joinpath</span>(<span class="cn">ENV</span>[<span class="st">"TMPDIR"</span>], <span class="st">"figures"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> !<span class="fu">isdir</span>(outdir)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mkdir</span>(outdir)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>"C:/Users/bram.van.moorter/Documents/ConScape_website/site/notebooks/data/"</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mov_prob, meta_p <span class="op">=</span> ConScape.<span class="fu">readasc</span>(<span class="fu">joinpath</span>(datadir, <span class="st">"mov_prob_1000.asc"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hab_qual, meta_q <span class="op">=</span> ConScape.<span class="fu">readasc</span>(<span class="fu">joinpath</span>(datadir, <span class="st">"hab_qual_1000.asc"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>([NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN NaN … NaN NaN], Dict{Any, Any}("cellsize" =&gt; 1000.0, "nrows" =&gt; 87, "nodata_value" =&gt; -9999, "ncols" =&gt; 117, "xllcorner" =&gt; 110650.0, "yllcorner" =&gt; 6.89575e6))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>non_matches <span class="op">=</span> <span class="fu">findall</span>(<span class="fu">xor</span>.(<span class="fu">isnan</span>.(mov_prob), <span class="fu">isnan</span>.(hab_qual)))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mov_prob[non_matches] <span class="op">.=</span> <span class="fl">1e-20</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>hab_qual[non_matches] <span class="op">.=</span> <span class="fl">1e-20</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>θ <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>adjacency_matrix <span class="op">=</span> ConScape.<span class="fu">graph_matrix_from_raster</span>(mov_prob)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> ConScape.<span class="fu">Grid</span>(<span class="fu">size</span>(mov_prob)<span class="op">...</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    affinities<span class="op">=</span>adjacency_matrix,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    qualities<span class="op">=</span>hab_qual,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    costs<span class="op">=</span>ConScape.<span class="fu">mapnz</span>(x <span class="op">-&gt;</span> <span class="fu">-log</span>(x), adjacency_matrix))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> ConScape.<span class="fu">GridRSP</span>(g, θ <span class="op">=</span> θ);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Info: cost graph contains 4835 strongly connected subgraphs
└ @ ConScape C:\Users\bram.van.moorter\.julia\packages\ConScape\spkWs\src\grid.jl:215</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Info: removing 4834 nodes from affinity and cost graphs
└ @ ConScape C:\Users\bram.van.moorter\.julia\packages\ConScape\spkWs\src\grid.jl:225</code></pre>
</div>
</div>
</section>
<section id="euclidean-distance" class="level2">
<h2 class="anchored" data-anchor-id="euclidean-distance">Euclidean distance</h2>
<p>Compute the Euclidean distance between all pairs of source and target pixels:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>euclid <span class="op">=</span> [<span class="fu">hypot</span>(xy_i[<span class="fl">1</span>] <span class="op">-</span> xy_j[<span class="fl">1</span>], xy_i[<span class="fl">2</span>] <span class="op">-</span> xy_j[<span class="fl">2</span>]) for xy_i <span class="kw">in</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    g.id_to_grid_coordinate_list, xy_j <span class="kw">in</span> g.id_to_grid_coordinate_list]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>5345×5345 Matrix{Float64}:
   0.0        1.0        2.0      …  116.108    116.25     116.966
   1.0        0.0        1.0         115.974    116.108    116.842
   2.0        1.0        0.0         115.849    115.974    116.726
   3.0        2.0        1.0         115.732    115.849    116.619
   4.0        3.0        2.0         115.624    115.732    116.52
   1.0        1.41421    2.23607  …  115.117    115.261    115.974
   1.41421    1.0        1.41421     114.983    115.117    115.849
   2.23607    1.41421    1.0         114.856    114.983    115.732
   3.16228    2.23607    1.41421     114.739    114.856    115.624
   4.12311    3.16228    2.23607     114.63     114.739    115.525
   5.09902    4.12311    3.16228  …  114.529    114.63     115.434
   2.23607    2.82843    3.60555     114.272    114.425    115.117
   2.0        2.23607    2.82843     114.127    114.272    114.983
   ⋮                              ⋱                        
 114.756    114.586    114.425         4.47214    3.60555    5.83095
 114.935    114.756    114.586         5.38516    4.47214    6.7082
 114.856    114.739    114.63     …    2.23607    3.16228    2.23607
 114.983    114.856    114.739         1.41421    2.23607    2.0
 115.117    114.983    114.856         1.0        1.41421    2.23607
 115.261    115.117    114.983         1.41421    1.0        2.82843
 115.412    115.261    115.117         2.23607    1.41421    3.60555
 115.849    115.732    115.624    …    2.0        3.0        1.41421
 115.974    115.849    115.732         1.0        2.0        1.0
 116.108    115.974    115.849         0.0        1.0        1.41421
 116.25     116.108    115.974         1.0        0.0        2.23607
 116.966    116.842    116.726         1.41421    2.23607    0.0</code></pre>
</div>
</div>
<p>The distance from all source pixels to a given target pixel (e.g.&nbsp;pixel 4300):</p>
<div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">5345</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>tmp[<span class="fl">4300</span>] <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(ConScape.<span class="fu">plot_values</span>(g, tmp, title<span class="op">=</span><span class="st">"Target"</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(ConScape.<span class="fu">plot_values</span>(g, euclid[<span class="op">:</span>,<span class="fl">4300</span>], title<span class="op">=</span><span class="st">"Euclidean distance"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-execution_count="8">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_distance_metrics_files/figure-html/cell-9-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">a</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_distance_metrics_files/figure-html/cell-9-output-2.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">b</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>Euclidean distance to target t.</p>
</div>
</div>
</div>
</div>
</section>
<section id="least-cost-distance" class="level2">
<h2 class="anchored" data-anchor-id="least-cost-distance">Least-cost distance</h2>
<p>From the <code>Grid</code> we can also compute the least-cost distances betweem <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>lcps <span class="op">=</span> ConScape.<span class="fu">least_cost_distance</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>5345×5345 Matrix{Float64}:
   0.0      46.0517    92.1034    95.6402   …  324.669   324.322   340.565
  46.0517    0.0       46.0517    49.5885      278.617   278.271   294.513
  92.1034   46.0517     0.0       46.0517      275.774   275.427   291.669
  95.6402   49.5885    46.0517     0.0         275.427   275.08    291.323
  97.6873   51.6356    48.792     46.0517      275.33    274.983   291.226
  46.0517   46.3983    53.9123    54.2589   …  283.288   282.941   299.183
  46.3983   46.0517    46.3983    49.2419      278.271   277.924   294.166
  49.2419    3.19019    2.84362    3.19019     232.219   231.872   248.115
  51.2891    5.23737    2.39375    2.04718     229.375   229.029   245.271
  53.5857    7.53404    4.69042    2.64324     229.278   228.932   245.174
  99.6374   53.5857    50.7421    48.6949   …  273.38    273.033   289.276
  50.8639   15.963     15.6164    15.963       244.992   244.645   260.888
  49.6884   11.4973    11.1507    11.4973      240.526   240.179   256.422
   ⋮                                        ⋱                      
 264.586   218.534    215.69     215.344        49.5023   38.1418   66.2053
 264.13    218.079    215.235    214.888        60.135    49.1979   76.838
 282.906   236.854    234.011    233.664    …   26.2618   38.6569   28.6819
 278.796   232.744    229.901    229.554        13.129    26.5877   28.4995
 278.631   232.579    229.735    229.389        13.4586   13.8052   29.5223
 278.271   232.219    229.375    229.029        13.7918   13.4452   30.4948
 278.915   232.863    230.02     229.673        27.5348   14.0896   44.2379
 294.345   248.293    245.45     245.103    …   28.6782   42.1369   15.5492
 294.513   248.461    245.618    245.271        15.7171   29.8689   15.7171
 294.974   248.922    246.078    245.732         0.0      16.3565   16.703
 293.405   247.354    244.51     244.164        15.1349    0.0      31.8379
 311.506   265.455    262.611    262.265        17.3399   33.6964    0.0</code></pre>
</div>
</div>
<p>The least-cost distance from all source pixels to target pixel 4300 is:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">plot_values</span>(g, lcps[<span class="fl">4300</span>,<span class="op">:</span>], title<span class="op">=</span><span class="st">"Least-cost distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_distance_metrics_files/figure-html/cell-11-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Least-cost distance to target t.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Not too surprising there is a high, albeit imperfect, correlation between the Euclidean and least-cost distance:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(euclid[<span class="op">:</span>,<span class="fl">4300</span>], lcps[<span class="fl">4300</span>,<span class="op">:</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>0.9523159537210744</code></pre>
</div>
</div>
</section>
<section id="rsp-expected-cost-distance" class="level2">
<h2 class="anchored" data-anchor-id="rsp-expected-cost-distance">RSP expected cost distance</h2>
<p>The randomized shortest path (RSP) expected cost distance is the expected cost of moving from the source to the target following the RSP distribution:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dists <span class="op">=</span> ConScape.<span class="fu">expected_cost</span>(h);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The RSP expected cost from all pixels as sources to target pixel 4300:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">plot_values</span>(g, dists[<span class="op">:</span>,<span class="fl">4300</span>], title<span class="op">=</span><span class="st">"RSP expected cost distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_distance_metrics_files/figure-html/cell-14-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">RSP expected cost distance to target t.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Comparing the least-cost distance to the RSP expected cost distance we see there is strong positive relationship:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(lcps[<span class="op">:</span>,<span class="fl">4300</span>], dists[<span class="op">:</span>,<span class="fl">4300</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>0.9413616748832977</code></pre>
</div>
</div>
<p>Most computations in ConScape require a proximity instead of a distance. A proximity is a metric from zero to one, with zero no connectivity and one perfect connectivity between a source and a target. Different transformations can be used for this, a common choice is the exponential transformation with a scaling factor (here: 1000) representing the movement capabilities of a species (see <span class="citation" data-cites="vanmoorter2021defining">(<a href="#ref-vanmoorter2021defining" role="doc-biblioref">Moorter et al. 2021</a>)</span> for a discussion):</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">plot_values</span>(g, <span class="fu">map</span>(x <span class="op">-&gt;</span> <span class="fu">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="fl">1000</span>), dists[<span class="op">:</span>,<span class="fl">4300</span>]), title<span class="op">=</span><span class="st">"Proximity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_distance_metrics_files/figure-html/cell-16-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">RSP expected cost proximity (logarithm) to target t.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="survival-probability" class="level2">
<h2 class="anchored" data-anchor-id="survival-probability">Survival probability</h2>
<p><span class="citation" data-cites="fletcher2019towards">(<a href="#ref-fletcher2019towards" role="doc-biblioref">Fletcher Jr et al. 2019</a>)</span> introduced the use of the ‘absorbing Markov chain’ or ‘killed random walk’ to connectivity modeling in landscape ecology (see also: <span class="citation" data-cites="vanmoorter2021defining">(<a href="#ref-vanmoorter2021defining" role="doc-biblioref">Moorter et al. 2021</a>)</span>). The RSP framework uses the same formalism and can be considered a generalization of the absorbing Markov chain in (<span class="citation" data-cites="fletcher2019towards">(<a href="#ref-fletcher2019towards" role="doc-biblioref">Fletcher Jr et al. 2019</a>)</span>) with the introduction of the <span class="math inline">\(\theta\)</span> paramter, see (<span class="citation" data-cites="vanmoorter2021defining">(<a href="#ref-vanmoorter2021defining" role="doc-biblioref">Moorter et al. 2021</a>)</span>) for discussion. Here we show ConScape’s functionality to use the survival probability from source to target as a proximtiy metric:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>surv_prob <span class="op">=</span> ConScape.<span class="fu">survival_probability</span>(h);</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">plot_values</span>(g, surv_prob[<span class="op">:</span>,<span class="fl">4300</span>], title<span class="op">=</span><span class="st">"Survival proximity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_distance_metrics_files/figure-html/cell-17-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Survival proximity to target t.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The proximity based on the expected cost and on the survival probability show a strong positive relationship:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="fu">map</span>(x <span class="op">-&gt;</span> <span class="fu">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="fl">1000</span>), dists[<span class="op">:</span>,<span class="fl">4300</span>]), surv_prob[<span class="op">:</span>,<span class="fl">4300</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>0.948207086404158</code></pre>
</div>
</div>
<p>For more discussion on the use of the survival probability, in the context of the RSP framework we refer to (<span class="citation" data-cites="vanmoorter2021defining">(<a href="#ref-vanmoorter2021defining" role="doc-biblioref">Moorter et al. 2021</a>)</span>) and more specifically in the context of ConScape to Notebook <a href="../notebooks/nbk_cost.html">dispersal mortality</a>.</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>In ConScape different metrics are available to characterize the connectivity between source and target pixels. The metric that is most appropriate will depend upon the ecological application. <span class="citation" data-cites="vanmoorter2021defining">(<a href="#ref-vanmoorter2021defining" role="doc-biblioref">Moorter et al. 2021</a>)</span> suggest the use of the RSP expected cost for applications modeling individuals that move with knowledge of their landscape, whereas the survival probability is probably a more appropriate model for dispersing individuals experiencing mortality (<span class="citation" data-cites="fletcher2019towards">(<a href="#ref-fletcher2019towards" role="doc-biblioref">Fletcher Jr et al. 2019</a>)</span> for this last type of applications).</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-fletcher2019towards" class="csl-entry" role="doc-biblioentry">
Fletcher Jr, Robert J, Jorge A Sefair, Chao Wang, Caroline L Poli, Thomas AH Smith, Emilio M Bruna, Robert D Holt, Michael Barfield, Andrew J Marx, and Miguel A Acevedo. 2019. <span>“Towards a Unified Framework for Connectivity That Disentangles Movement and Mortality in Space and Time.”</span> <em>Ecology Letters</em> 22 (10): 1680–89.
</div>
<div id="ref-vanmoorter2021defining" class="csl-entry" role="doc-biblioentry">
Moorter, Bram van, Ilkka Kivimäki, Manuela Panzacchi, and Marco Saerens. 2021. <span>“Defining and Quantifying Effective Connectivity of Landscapes for Species’ Movements.”</span> <em>Ecography</em> 44 (6): 870–84.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notebooks/nbk_landmarks.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Performance</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notebooks/nbk_cost.html" class="pagination-link">
        <span class="nav-page-text">Dispersal mortality</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-right">This page is powered by <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>