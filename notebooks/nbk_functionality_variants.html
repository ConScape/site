<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ConScape - the docs - Functional habitat</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../faq.html" rel="next">
<link href="../notebooks/nbk_cost.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Functional habitat</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/stickerConScape.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Home</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quick_start.html" class="sidebar-item-text sidebar-link">Quick start</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../background.html" class="sidebar-item-text sidebar-link">Background</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../applications/index.html" class="sidebar-item-text sidebar-link">Applications</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../applications/GI.html" class="sidebar-item-text sidebar-link">Green infrastructure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../applications/EIA.html" class="sidebar-item-text sidebar-link">Environmental impact assessment</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Tutorials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/index.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_getting_started.html" class="sidebar-item-text sidebar-link">Getting started</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_landmarks.html" class="sidebar-item-text sidebar-link">Performance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_distance_metrics.html" class="sidebar-item-text sidebar-link">Ecological distance</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_cost.html" class="sidebar-item-text sidebar-link">Dispersal mortality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/nbk_functionality_variants.html" class="sidebar-item-text sidebar-link active">Functional habitat</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../faq.html" class="sidebar-item-text sidebar-link">FAQ</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../faqV2.html" class="sidebar-item-text sidebar-link">FAQ</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../glossary.html" class="sidebar-item-text sidebar-link">Glossary</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../acknowledgments.html" class="sidebar-item-text sidebar-link">Acknowledgments</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../team.html" class="sidebar-item-text sidebar-link">The team and contact</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../blog.html" class="sidebar-item-text sidebar-link">Blog</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#demonstration-of-functional-habitat-computation" id="toc-demonstration-of-functional-habitat-computation" class="nav-link active" data-scroll-target="#demonstration-of-functional-habitat-computation">Demonstration of functional habitat computation</a>
  <ul class="collapse">
  <li><a href="#data-import-grid-and-gridrsp-creation" id="toc-data-import-grid-and-gridrsp-creation" class="nav-link" data-scroll-target="#data-import-grid-and-gridrsp-creation">Data import, <code>Grid</code> and <code>GridRSP</code> creation</a></li>
  <li><a href="#habitat-functionality-introduction" id="toc-habitat-functionality-introduction" class="nav-link" data-scroll-target="#habitat-functionality-introduction">Habitat functionality: introduction</a></li>
  <li><a href="#functionality-rsp-expected-cost-with-summation" id="toc-functionality-rsp-expected-cost-with-summation" class="nav-link" data-scroll-target="#functionality-rsp-expected-cost-with-summation">Functionality: RSP expected cost with summation</a></li>
  <li><a href="#functionality-rsp-expected-cost-with-eigenanalysis" id="toc-functionality-rsp-expected-cost-with-eigenanalysis" class="nav-link" data-scroll-target="#functionality-rsp-expected-cost-with-eigenanalysis">Functionality: RSP expected cost with eigenanalysis</a></li>
  <li><a href="#functionality-survival-probability-with-summation" id="toc-functionality-survival-probability-with-summation" class="nav-link" data-scroll-target="#functionality-survival-probability-with-summation">Functionality: survival probability with summation</a></li>
  <li><a href="#functionality-least-cost-distance-with-summation" id="toc-functionality-least-cost-distance-with-summation" class="nav-link" data-scroll-target="#functionality-least-cost-distance-with-summation">Functionality: least-cost distance with summation</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Functional habitat</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Here you will learn
</div>
</div>
<div class="callout-body-container callout-body">
<p>Different ways to compute the amount of connected habitat for a pixel/cell or functional habitat in ConScape.</p>
</div>
</div>
<section id="demonstration-of-functional-habitat-computation" class="level1">
<h1>Demonstration of functional habitat computation</h1>
<p>In this notebook we demonstrate the different ways the amount of connected habitat or `habitat functionality’ can be computed with ConScape.</p>
<section id="data-import-grid-and-gridrsp-creation" class="level2">
<h2 class="anchored" data-anchor-id="data-import-grid-and-gridrsp-creation">Data import, <code>Grid</code> and <code>GridRSP</code> creation</h2>
<p>See notebook <a href="../notebooks/nbk_getting_started.html">Getting Started</a> for a ‘basic workflow’ to learn about the fundamentals on data import and the creation of a ConScape <code>Grid</code>:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#using Pkg</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Pkg.activate(joinpath(ENV["HOME"], ".julia", "dev", "ConScape"))</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ConScape</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SparseArrays</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>datadir <span class="op">=</span> <span class="fu">joinpath</span>(<span class="cn">ENV</span>[<span class="st">"HOME"</span>], <span class="st">"Downloads"</span>, <span class="st">"input_maps"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>outdir <span class="op">=</span> <span class="fu">joinpath</span>(<span class="cn">ENV</span>[<span class="st">"TMPDIR"</span>], <span class="st">"figures"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> !<span class="fu">isdir</span>(outdir)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mkdir</span>(outdir)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>"C:/Users/bram.van.moorter/Documents/ConScape_website/site/notebooks/data/"</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mov_prob, meta_p <span class="op">=</span> ConScape.<span class="fu">readasc</span>(<span class="fu">joinpath</span>(datadir, <span class="st">"mov_prob_1000.asc"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hab_qual, meta_q <span class="op">=</span> ConScape.<span class="fu">readasc</span>(<span class="fu">joinpath</span>(datadir, <span class="st">"hab_qual_1000.asc"</span>));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>non_matches <span class="op">=</span> <span class="fu">findall</span>(<span class="fu">xor</span>.(<span class="fu">isnan</span>.(mov_prob), <span class="fu">isnan</span>.(hab_qual)))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mov_prob[non_matches] <span class="op">.=</span> <span class="fl">1e-20</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>hab_qual[non_matches] <span class="op">.=</span> <span class="fl">1e-20</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>θ <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>adjacency_matrix <span class="op">=</span> ConScape.<span class="fu">graph_matrix_from_raster</span>(mov_prob)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> ConScape.<span class="fu">Grid</span>(<span class="fu">size</span>(mov_prob)<span class="op">...</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    affinities<span class="op">=</span>adjacency_matrix,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    qualities<span class="op">=</span>hab_qual,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    costs<span class="op">=</span>ConScape.<span class="fu">mapnz</span>(x <span class="op">-&gt;</span> <span class="fu">-log</span>(x), adjacency_matrix))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> ConScape.<span class="fu">GridRSP</span>(g, θ <span class="op">=</span> θ);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Info: cost graph contains 4835 strongly connected subgraphs
└ @ ConScape C:\Users\bram.van.moorter\.julia\packages\ConScape\spkWs\src\grid.jl:215</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Info: removing 4834 nodes from affinity and cost graphs
└ @ ConScape C:\Users\bram.van.moorter\.julia\packages\ConScape\spkWs\src\grid.jl:225</code></pre>
</div>
</div>
</section>
<section id="habitat-functionality-introduction" class="level2">
<h2 class="anchored" data-anchor-id="habitat-functionality-introduction">Habitat functionality: introduction</h2>
<p>We have defined the functionality of habitat as its suitability and its functional connectivity to suitable habitat, which has its background in metapopulation theory (<span class="citation" data-cites="hanski1999metapopulation">(<a href="#ref-hanski1999metapopulation" role="doc-biblioref">Hanski 1999</a>)</span>,<span class="citation" data-cites="hanski2000metapopulation">(<a href="#ref-hanski2000metapopulation" role="doc-biblioref">Hanski and Ovaskainen 2000</a>)</span>). Hanski and co-workers developed several of such metrics for patch-matrix representations of the landscape. In ConScape these different metrics are computed for continuous grid-based landscape representations. In the following we show the computation of the functionality of a pixel based: (1) on the RSP expected cost between source and target pixels and on the summation over sources or targets, (2) on eigenanalysis instead of summation, (3) on the survival probability instead of the RSP expected cost, (4) on the least-cost distance instead of the RSP expected cost. This last version corresponds to the popular ‘probability of connectivity’ (<span class="citation" data-cites="saura2007new">(<a href="#ref-saura2007new" role="doc-biblioref">Saura and Pascual-Hortal 2007</a>)</span>).</p>
</section>
<section id="functionality-rsp-expected-cost-with-summation" class="level2">
<h2 class="anchored" data-anchor-id="functionality-rsp-expected-cost-with-summation">Functionality: RSP expected cost with summation</h2>
<p>Before demonstrating the convenience function ConScape has to computate the amount of connected habitat, we will demonstrate explicitly the main building blocks going into this computation.</p>
<p>First, we need extract the vectors with the qualities <span class="math inline">\(s\)</span> of the pixels as source <span class="math inline">\(s\)</span> and target <span class="math inline">\(t\)</span>:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>targetidx, targetnodes <span class="op">=</span> ConScape.<span class="fu">_targetidx_and_nodes</span>(h.g)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>qˢ <span class="op">=</span> [h.g.source_qualities[i] for i <span class="kw">in</span> h.g.id_to_grid_coordinate_list]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>qᵗ <span class="op">=</span> [h.g.target_qualities[i] for i <span class="kw">in</span> targetidx];</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we compute the proximity matrix between <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> using the RSP expected cost:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="fu">map</span>(t <span class="op">-&gt;</span> <span class="fu">iszero</span>(t) ? t <span class="op">:</span> <span class="fu">exp</span>(<span class="op">-</span>t<span class="op">/</span><span class="fl">2000</span>), ConScape.<span class="fu">expected_cost</span>(h));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>See Notebook <a href="../notebooks/nbk_distance_metrics.html">ecological distance</a> for a discussion of the proximity computation.</p>
<p>From the these quality vectors <span class="math inline">\(q^s\)</span> and <span class="math inline">\(q^t\)</span>, and the proximity matrix <span class="math inline">\(\mathbf{K}\)</span> we compute the ‘landscape matrix’ <span class="math inline">\(\mathbf{M}\)</span>:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> qˢ <span class="op">.*</span> K <span class="op">.*</span> qᵗ<span class="op">'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The landscape matrix <span class="math inline">\(\mathbf{M}\)</span> can be summarized either through summation or Eigenanalysis, both can be used to quantify the functionality of a pixel as a source or as a target. The next section demonstrates Eigenanalysis, we first look at summation to summarize <span class="math inline">\(\mathbf{M}\)</span>. By summing over all rows, we get how well suitable target habitat is connected to suitable sources:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>funcᵗ <span class="op">=</span> <span class="fu">vec</span>(<span class="fu">sum</span>(M, dims<span class="op">=</span><span class="fl">1</span>)); <span class="co">#sum over rows</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">plot_values</span>(g, funcᵗ, title<span class="op">=</span><span class="st">"Functional habitat"</span>, color<span class="op">=</span><span class="fu">cgrad</span>(<span class="op">:</span>viridis))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div id="fig-target_functionality" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="nbk_functionality_variants_files/figure-html/fig-target_functionality-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Habitat functionality of each pixel as a target (i.e.&nbsp;in receiving suitable habitat from sources).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Similarly, by summing over all columns, we quantify how well suitable source habitat is connected to suitable target habitat:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>funcˢ <span class="op">=</span> <span class="fu">vec</span>(<span class="fu">sum</span>(M, dims<span class="op">=</span><span class="fl">2</span>)); <span class="co">#sum over columns</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">plot_values</span>(g, funcˢ, title<span class="op">=</span><span class="st">"Functional habitat"</span>, color<span class="op">=</span><span class="fu">cgrad</span>(<span class="op">:</span>viridis))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_functionality_variants_files/figure-html/cell-12-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Habitat functionality of each pixel as a source (i.e.&nbsp;in contributing suitable habitat to targets).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We could then multiply the functionality of a pixel as a source and as a target to identify pixels that are simultaneously functional as source and target.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>func_tot <span class="op">=</span> funcˢ <span class="op">.*</span> funcᵗ;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that this last computation is only possible, if func<span class="math inline">\(^s\)</span> and func<span class="math inline">\(^t\)</span> are of the same length. In other words, the the target qualities cannot be represented as a sparse matrix (see Van Moorter et al.&nbsp;2022 and Notebook <a href="../notebooks/nbk_landmarks.html">performance</a> for more details).</p>
<p>ConScape’s convenience function focuses on the ‘source functionality’ to allow for the usage of the sparse matrix representation of target qualities, which allows the computation of these metrics on even larger landscapes (see Notebook <a href="../notebooks/nbk_landmarks.html">performance</a> for explanation):</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>func <span class="op">=</span> ConScape.<span class="fu">connected_habitat</span>(h, connectivity_function<span class="op">=</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    ConScape.expected_cost, distance_transformation<span class="op">=</span>x <span class="op">-&gt;</span> <span class="fu">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="fl">2000</span>));</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">heatmap</span>(func, yflip<span class="op">=</span><span class="cn">true</span>, color<span class="op">=</span><span class="fu">cgrad</span>(<span class="op">:</span>viridis), title<span class="op">=</span><span class="st">"Functional habitat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_functionality_variants_files/figure-html/cell-14-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Habitat functionality of each pixel as a target using ConScape’s convenience function.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>is identical to the one in Fig. <a href="#fig-target_functionality">Figure&nbsp;1</a>.</p>
</section>
<section id="functionality-rsp-expected-cost-with-eigenanalysis" class="level2">
<h2 class="anchored" data-anchor-id="functionality-rsp-expected-cost-with-eigenanalysis">Functionality: RSP expected cost with eigenanalysis</h2>
<p>In addition to summarizing the landscape matrix <span class="math inline">\(\mathbf{M}\)</span> through summation, we can also use Eigenanalysis:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>vˡ, λ, vʳ<span class="op">=</span> ConScape.<span class="fu">eigmax</span>(h, connectivity_function<span class="op">=</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    ConScape.expected_cost, distance_transformation<span class="op">=</span>x <span class="op">-&gt;</span> <span class="fu">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="fl">2000</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>vʳ <span class="op">=</span> <span class="fu">real</span>.(vʳ)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>vˡ <span class="op">=</span> <span class="fu">real</span>.(vˡ);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Where <span class="math inline">\(\lambda\)</span> corresponds to the ‘metapopulation capacity’ in metapopulation ecology (<span class="citation" data-cites="hanski2000metapopulation">(<a href="#ref-hanski2000metapopulation" role="doc-biblioref">Hanski and Ovaskainen 2000</a>)</span>):</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>λ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>354.16197335389097</code></pre>
</div>
</div>
<p>The interpretation of this value outside the context of metapopulation theory still needs to be addressed in future research.</p>
<p>The right Eigenvector corresponds to the reproductive value, which is analogous to the functionality as a source:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">plot_values</span>(g, vʳ, title<span class="op">=</span><span class="st">"Reproductive value"</span>, color<span class="op">=</span><span class="fu">cgrad</span>(<span class="op">:</span>viridis))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_functionality_variants_files/figure-html/cell-17-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Habitat functionality based on eigenanalysis of each pixel as a target (i.e.&nbsp;the reproductive value).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Note that the landscape matrix <span class="math inline">\(\mathbf{M}^{st}\)</span> is transposed compared to (e.g. <span class="citation" data-cites="ovaskainen2003much">(<a href="#ref-ovaskainen2003much" role="doc-biblioref">Ovaskainen and Hanski 2003</a>)</span>) and therefore the right and left Eigenvectors switched interpretation.</p>
<p>The left Eigenvector then corresponds to the stable distribution, which is somewhat analogous to the functionality as a target:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">plot_values</span>(g, vˡ, title<span class="op">=</span><span class="st">"Stable distribution"</span>, color<span class="op">=</span><span class="fu">cgrad</span>(<span class="op">:</span>viridis))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_functionality_variants_files/figure-html/cell-18-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Habitat functionality based on eigenanalysis of each pixel as a source (i.e.&nbsp;the stable distribution).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Just as <span class="citation" data-cites="ovaskainen2003habitat">(<a href="#ref-ovaskainen2003habitat" role="doc-biblioref">Ovaskainen 2003</a>)</span> we can multiply the left and right Eigenvectors:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>eigenvec <span class="op">=</span> vˡ <span class="op">.*</span> vʳ;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An important note, Eigenanalysis requires the landscape matrix <span class="math inline">\(\mathbf{M}^{st}\)</span> to be square, hence the sparse matrix representation of the target qualities is not possible (see main text and Notebook <a href="../notebooks/nbk_landmarks.html">performance</a> for more details). Hence, we cannot rely on the ‘landmark’ approach to reduce the computational demands, which currently limits this type of eigenanalysis to relatively coarse landscape representations.</p>
</section>
<section id="functionality-survival-probability-with-summation" class="level2">
<h2 class="anchored" data-anchor-id="functionality-survival-probability-with-summation">Functionality: survival probability with summation</h2>
<p>See also Notebook <a href="../notebooks/nbk_distance_metrics.html">ecological distance</a> for more details on the different distance and proximity metrics that can be used. We now demonstrate the use of the survival probability as an alternative metric to compute the amount of suitable target habitat that is functionally connected to a suitable source pixel:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>func_surv <span class="op">=</span> ConScape.<span class="fu">connected_habitat</span>(h,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>        connectivity_function<span class="op">=</span>ConScape.survival_probability);</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">heatmap</span>(func_surv, yflip<span class="op">=</span><span class="cn">true</span>, title<span class="op">=</span><span class="st">"Habitat functionality"</span>, color<span class="op">=</span><span class="fu">cgrad</span>(<span class="op">:</span>viridis))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_functionality_variants_files/figure-html/cell-20-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Habitat functionality based on survival probability.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>See Notebook <a href="../notebooks/nbk_cost.html">dispersal mortality</a> for more details on the use of mortality data as the basis for survival connectivity.</p>
</section>
<section id="functionality-least-cost-distance-with-summation" class="level2">
<h2 class="anchored" data-anchor-id="functionality-least-cost-distance-with-summation">Functionality: least-cost distance with summation</h2>
<p>Our final demonstration to quantify the amount of connected habitat is related to the ‘probability of connectivity’ <span class="citation" data-cites="saura2007new">(<a href="#ref-saura2007new" role="doc-biblioref">Saura and Pascual-Hortal 2007</a>)</span> and the ‘cost-benefit analysis’ (<span class="citation" data-cites="drielsma2007raster">(<a href="#ref-drielsma2007raster" role="doc-biblioref">Drielsma, Ferrier, and Manion 2007</a>)</span>,<span class="citation" data-cites="drielsma2007spatial">(<a href="#ref-drielsma2007spatial" role="doc-biblioref">Drielsma, Manion, and Ferrier 2007</a>)</span>). These approaches both are built from the least-cost distance between source and target pixels. Although the RSP expected cost in theory includes the least-cost distance for <span class="math inline">\(\theta \rightarrow \infty\)</span>, it is not an efficient algorithm to use for least-cost based distances. We therefore implemented convenience functions to use Julia’s implementation of the Dijkstra algorithm to compute the least-cost distance:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>func_lc <span class="op">=</span> ConScape.<span class="fu">connected_habitat</span>(g, connectivity_function<span class="op">=</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    ConScape.least_cost_distance, distance_transformation<span class="op">=</span>x <span class="op">-&gt;</span> <span class="fu">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="fl">40</span>));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The ‘connectivity of a landscape’ from (<span class="citation" data-cites="drielsma2007spatial">(<a href="#ref-drielsma2007spatial" role="doc-biblioref">Drielsma, Manion, and Ferrier 2007</a>)</span>) is then the sum of all elements in the landscape matrix <span class="math inline">\(\mathbf{M}^{st}\)</span>:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>CL<span class="op">=</span><span class="fu">sum</span>(<span class="fu">filter</span>(x <span class="op">-&gt;</span> !<span class="fu">isnan</span>(x), func_lc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>518459.3477832595</code></pre>
</div>
</div>
<p>And the ‘probability of connectivity’ further divides this ‘connectivity of the landscape’ by the squared area of the landscape (<span class="citation" data-cites="saura2007new">(<a href="#ref-saura2007new" role="doc-biblioref">Saura and Pascual-Hortal 2007</a>)</span>):</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>PC<span class="op">=</span>CL<span class="op">/</span><span class="fu">sum</span>(<span class="fu">map</span>(x <span class="op">-&gt;</span> <span class="fu">isnan</span>(x) ? <span class="fl">0</span> <span class="op">:</span> <span class="fl">1</span>, func_lc))<span class="op">^</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0.01814760383958709</code></pre>
</div>
</div>
<p>In addition, as above we can compute the source and target functionalities using the least-cost distance by respectively summing over all columns or all rows of the landscape matrix <span class="math inline">\(\mathbf{M}^{st}\)</span>, this corresponds to the colonization potential in <span class="citation" data-cites="drielsma2007raster">(<a href="#ref-drielsma2007raster" role="doc-biblioref">Drielsma, Ferrier, and Manion 2007</a>)</span>:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ConScape.<span class="fu">heatmap</span>(func_lc, yflip<span class="op">=</span><span class="cn">true</span>, title<span class="op">=</span><span class="st">"Colonization potential"</span>, color<span class="op">=</span><span class="fu">cgrad</span>(<span class="op">:</span>viridis))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="nbk_functionality_variants_files/figure-html/cell-24-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Habitat functionality based on the least-cost distance, which corresponds to the ‘colonization potential’ in <span class="citation" data-cites="drielsma2007raster">(<a href="#ref-drielsma2007raster" role="doc-biblioref">Drielsma, Ferrier, and Manion 2007</a>)</span>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>ConScape allows for several different ‘habitat functionality’ metrics by combining different distance or proximity metrics to quantify the connectivity between sources and targets with different ways of summarizing across sources and/or targets. Theoretically, the RSP expected cost is a generalized version of the least-cost distance (i.e.&nbsp;RSP expected cost equals the least-cost distance for <span class="math inline">\(\theta \rightarrow \infty\)</span>), although numerical issues with the current algorithms prevent the usage of the RSP expected cost to replace the least-cost distance in actual applications. In addition to the RSP expected cost (and least-cost distance), ConScape also offers the survival probability to quantify the connectivity between source and target pixels. Two summary statistics have been proposed to quantify habitat functionality: summation and eigenanalysis. Summation was first proposed in <span class="citation" data-cites="hanski1999metapopulation">(<a href="#ref-hanski1999metapopulation" role="doc-biblioref">Hanski 1999</a>)</span> with the ‘neighborhood habitat area index’, whereas <span class="citation" data-cites="hanski2000metapopulation">(<a href="#ref-hanski2000metapopulation" role="doc-biblioref">Hanski and Ovaskainen 2000</a>)</span> proposed eigenanalysis to quantify the ‘metapopulation capacity’ for metapopulation persistence. Both of these approaches have been implemented in ConScape, however, the computational requirements for eigenanalysis may prevent this approach on large landscapes.</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-drielsma2007raster" class="csl-entry" role="doc-biblioentry">
Drielsma, Michael, Simon Ferrier, and Glenn Manion. 2007. <span>“A Raster-Based Technique for Analysing Habitat Configuration: The Cost–Benefit Approach.”</span> <em>Ecological Modelling</em> 202 (3-4): 324–32.
</div>
<div id="ref-drielsma2007spatial" class="csl-entry" role="doc-biblioentry">
Drielsma, Michael, Glenn Manion, and Simon Ferrier. 2007. <span>“The Spatial Links Tool: Automated Mapping of Habitat Linkages in Variegated Landscapes.”</span> <em>Ecological Modelling</em> 200 (3-4): 403–11.
</div>
<div id="ref-hanski1999metapopulation" class="csl-entry" role="doc-biblioentry">
Hanski, Ilkka. 1999. <em>Metapopulation Ecology</em>. Oxford University Press.
</div>
<div id="ref-hanski2000metapopulation" class="csl-entry" role="doc-biblioentry">
Hanski, Ilkka, and Otso Ovaskainen. 2000. <span>“The Metapopulation Capacity of a Fragmented Landscape.”</span> <em>Nature</em> 404 (6779): 755.
</div>
<div id="ref-ovaskainen2003habitat" class="csl-entry" role="doc-biblioentry">
Ovaskainen, Otso. 2003. <span>“Habitat Destruction, Habitat Restoration and Eigenvector–Eigenvalue Relations.”</span> <em>Mathematical Biosciences</em> 181 (2): 165–76.
</div>
<div id="ref-ovaskainen2003much" class="csl-entry" role="doc-biblioentry">
Ovaskainen, Otso, and Ilkka Hanski. 2003. <span>“How Much Does an Individual Habitat Fragment Contribute to Metapopulation Dynamics and Persistence?”</span> <em>Theoretical Population Biology</em> 64 (4): 481–95.
</div>
<div id="ref-saura2007new" class="csl-entry" role="doc-biblioentry">
Saura, Santiago, and Lucı́a Pascual-Hortal. 2007. <span>“A New Habitat Availability Index to Integrate Connectivity in Landscape Conservation Planning: Comparison with Existing Indices and Application to a Case Study.”</span> <em>Landscape and Urban Planning</em> 83 (2): 91–103.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notebooks/nbk_cost.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Dispersal mortality</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../faq.html" class="pagination-link">
        <span class="nav-page-text">FAQ</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-right">This page is powered by <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>